<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <title>自动驾驶物流大脑 - 数据大屏</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- favicon: 在标签页显示 logo -->
    <link rel="icon" href="image/logo.ico" type="image/ico sizes="32x32">
    <link rel="shortcut icon" href="image/logo.ico" type="image/ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/car-screen.css">
    <link rel="stylesheet" href="css/order-panel.css">
    <link rel="stylesheet" href="css/warehouse-panel.css">
    <link rel="stylesheet" href="css/vehicle-info-panel.css">
    <link rel="stylesheet" href="css/grid-info-panel.css">
    <script src="https://webapi.amap.com/maps?v=2.0&key=c9e8ebb3f3c7ada55ea870cd341d7c36&plugin=AMap.Scale,AMap.ToolBar,AMap.MapType,AMap.Map3D,AMap.Buildings"></script>
    <script src="js/echarts.min.js"></script>
    <script src="js/data.js"></script>
    <script src="js/500106_500107_streets.js"></script>
    <script src="js/car-screen.js" defer></script>
    <script src="js/order-panel.js" defer></script>
</head>
<body>
    <div class="top-title">
        <img src="image/logo.png" alt="logo" class="top-logo">
        <div class="top-title-text">自动驾驶物流大脑</div>
    </div>

    <!-- 左侧竖向统计栏 -->
    <div class="left-panels">
        <div class="panel u-neon-fixed" style="height: 40%;">
            <!-- 指标区域：两个容器上下排列，每个容器内指标同行 -->
            <div style="display: flex; margin: 0px 6px; margin-top: 16px;">
                <div class="metric" id="order-total">
                    <span class="summary-label"><a href="orders-manage.html">订单总数</a></span>
                    <span class="summary-num">--</span>
                </div>
                <div class="metric" id="order-finished">
                    <span class="summary-label"><a href="orders-manage.html?status=%E5%B7%B2%E5%AE%8C%E6%88%90">今日已完成</a></span>
                    <span class="summary-num">--</span>
                </div>
            </div>
            <div style="display: flex; margin: 0px 6px; margin-top: 8px;">
                <div class="metric" id="order-intransit">
                    <span class="summary-label"><a href="orders-manage.html?status=%E9%85%8D%E9%80%81%E4%B8%AD">在途订单</a></span>
                    <span class="summary-num">12</span>
                </div>
                <div class="metric" id="order-abnormal">
                    <span class="summary-label"><a href="orders-manage.html?status=%E5%BC%82%E5%B8%B8">异常订单</a></span>
                    <span class="summary-num">2</span>
                </div>
            </div>

            <div class="table-section">
                <!-- 列表表头：订单、类型、目的地、状态、备注 -->
                <div class="route-list-header" style="width: 96.5%; margin-top:12px; display: flex;">
                        <div style="flex:1.2; text-align:center;">订单</div>
                        <div style="flex:1; text-align:center;">类型</div>
                        <div style="flex:2; text-align:center;">目的地</div>
                        <div style="flex:1; text-align:center;">状态</div>
                        <div style="flex:2; text-align:center;">备注</div>
                </div>
                <ul id="orderListChart" class="list"></ul>
            </div>
        </div>
        <div class="panel u-neon-fixed" id="warehouse-panel" style="height: 50%; padding: 18px 12px 12px 12px; display: flex; flex-direction: column; gap: 10px;">
            <!-- 优化后的仓库门店信息面板组件 -->
            <div class="warehouse-panel-top" style="display: flex; gap: 6px; justify-content: space-between; margin: 10px 8px;">
                <div class="warehouse-stat laser-blue-border">
                    <div class="warehouse-stat-title"><i class="bi bi-building"></i> 仓库</div>
                    <div class="warehouse-stat-value" id="warehouse-total">50</div>
                </div>
                <div class="warehouse-stat laser-blue-border">
                    <div class="warehouse-stat-title"><i class="bi bi-shop"></i> 驿站/门店</div>
                    <div class="warehouse-stat-value" id="station-store-total">18</div>
                </div>
            </div>
            <div class="warehouse-panel-body" style="flex:1; display:flex;">
                <div class="warehouse-map-card" style="flex:1; display:flex; flex-direction:column; box-shadow:0 4px 24px rgba(30,150,255,0.10); border-radius:12px; padding:10px 10px 6px 10px;">
                    <div class="warehouse-map-card-title" style="display:flex; align-items:center; justify-content:space-between; margin-bottom:6px;">
                        <span><i class="bi bi-geo-alt"></i>站点预览</span>
                            <span class="warehouse-map-legend" style="font-size:12px; display:flex; align-items:center; gap:10px;">
                                <span class="legend-dot warehouse" style="display:inline-block; width:12px; height:12px; border-radius:50%; background:#4fc3f7; margin-right:3px;"></span>仓库
                                <span class="legend-dot store" style="display:inline-block; width:12px; height:12px; border-radius:50%; background:#fffb00; margin-right:3px;"></span>驿站/门店
                            </span>
                        </span>
                    </div>
                    <div id="warehouse-mini-map" class="warehouse-mini-map" style="flex:1; min-height:120px; border-radius:8px; border:1px solid rgba(255,255,255,0.03); overflow:hidden;"></div>
                </div>
            </div>
            <script src="js/warehouse-panel.js"></script>
        </div>
    </div>
    
    <!-- 浮动跳转按钮：固定到页面右下角，点击跳转到 route-manage.html -->
    <a id="route-manage-btn" class="floating-route-btn" href="route-manage.html" title="路线管理">
        <i class="bi bi-geo-alt-fill"></i>路线管理
    </a>
    <!-- 主体区域（地图/可视化） -->
    <div class="center-area">

        <!-- 浮动选择面板，左上角 -->
        <div class="floating-panel" id="floatingPanel">
            <div class="panel-group panel-label">
                总线路 <span class="panel-value">999</span>
            </div>
            <div class="panel-group">
                <label class="panel-checkbox">
                    <input type="checkbox" checked data-type="operation"> 运营线路
                    <span class="panel-value">99</span>
                </label>
            </div>
            <div class="panel-group">
                <label class="panel-checkbox">
                    <input type="checkbox" checked data-type="test"> 测试线路
                    <span class="panel-value">99</span>
                </label>
            </div>
            <div class="panel-group">
                <label class="panel-checkbox">
                    <input type="checkbox" checked data-type="warehouse"> 仓库
                </label>
                <label class="panel-checkbox">
                    <input type="checkbox" checked data-type="store"> 门店
                </label>
            </div>
            <div class="panel-group">
                <!-- <label class="panel-checkbox">
                    <input type="checkbox" checked data-type="cargo"> 货物
                </label> -->
                <label class="panel-checkbox">
                    <input type="checkbox" checked data-type="vehicle"> 车辆
                </label>
            </div>
        </div>
        <div class="visual">
            <div class="map-3d-wrap">
                <div id="mapContainerEcharts" class="mini-canvas placeholder">
                    <!-- 高德地图容器：initMap() 将在此容器中初始化 AMap 实例 -->
                    <div id="amapCar" style="width:100%;height:100%;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 右侧面板 -->
    <div class="right-panels">
        <div class="panel u-neon-fixed" style="height: 58%; border: 1.5px solid #1e90ff;">
            <!-- 车辆信息子面板嵌入 -->
            <div class="vehicle-info-panel">
                <div class="panel-header" id="vehicle-total">
                    <a href="car-manage.html">车辆总数</a> <span class="stat-value" id="total-value">128</span>
                </div>
                <div class="panel-stats-4">
                    <a class="stat-link" href="car-manage.html?status=%E9%85%8D%E9%80%81%E4%B8%AD" title="查看配送中车辆">
                        <div class="stat-block">
                            <div class="stat-label" id="stat-onroad">在途<br>车辆</div>
                            <div class="stat-value" id="onroad-value"></div>
                        </div>
                    </a>
                    <a class="stat-link" href="car-manage.html?status=%E7%A9%BA%E9%97%B4" title="查看空闲车辆">
                        <div class="stat-block">
                            <div class="stat-label" id="stat-idle">空闲<br>车辆</div>
                            <div class="stat-value" id="idle-value"></div>
                        </div>
                    </a>
                    <a class="stat-link" href="car-manage.html?status=%E5%85%85%E7%94%B5%E4%B8%AD" title="查看充电中车辆">
                        <div class="stat-block">
                            <div class="stat-label" id="stat-charging">充电<br>车辆</div>
                            <div class="stat-value" id="charging-value"></div>
                        </div>
                    </a>
                    <a class="stat-link" href="car-manage.html?status=%E5%BC%82%E5%B8%B8" title="查看异常车辆">
                        <div class="stat-block">
                            <div class="stat-label" id="stat-abnormal">异常<br>车辆</div>
                            <div class="stat-value" id="abnormal-value"></div>
                        </div>
                    </a>
                </div>
                <div class="panel-info">
                    <div class="info-col">
                        <div class="info-row">车辆ID：<span id="vehicle-id">--</span></div>
                        <div class="info-row">车辆类型：<span id="vehicle-type">--</span></div>
                        <div class="info-row">容量：<span id="vehicle-capacity">--</span></div>
                    </div>
                    <div class="info-col">
                        <div class="info-row">电量：<span id="vehicle-battery">--</span></div>
                        <div class="info-row">速度：<span id="vehicle-speed">--</span></div>
                        <div class="info-row">路线：<span id="vehicle-route">--</span></div>
                    </div>
                </div>
                <div class="info-row eta-row" style="margin: 4px 0 0 0; text-align: left; font-size: 1.01rem;">
                    预计送达时间：<span id="vehicle-eta">--</span>
                </div>
                <div class="panel-video-block">
                    <div class="panel-video-title">当前实时画面：</div>
                    <div class="panel-video" id="vehicle-video">
                            <video id="vehicle-demo-video" class="vehicle-demo-video" src="./test.mp4" autoplay muted loop playsinline controls="false"></video>
                        </div>
                </div>
            </div>
        </div>
        <div class="panel u-neon-fixed" style="height: 36%; display: flex; flex-direction: column; justify-content: center; align-items: stretch; padding: 0;">
            <!-- 网格员信息面板组件 -->
            <div class="grid-panel" id="grid-info-panel">
                <div class="grid-panel-header">
                    <span class="grid-panel-title"><a href="gridmember-profile.html">网格员总数：</a><span class="grid-panel-value" id="total-count">99</span></span>
                    <button class="grid-panel-distribution" id="distribution-btn">网格分布</button>
                </div>
                <div class="grid-panel-row">
                    <span class="grid-panel-label">在线网格员数：</span>
                    <span class="grid-panel-value" id="online-count">60</span>
                </div>
                <div class="grid-panel-row">
                    <span class="grid-panel-label">空闲网格员数：</span>
                    <span class="grid-panel-value" id="idle-count">20</span>
                </div>
                <div class="grid-panel-row">
                    <span class="grid-panel-label">离线网格员数：</span>
                    <span class="grid-panel-value" id="offline-count">5</span>
                </div>
            </div>
            <script src="js/grid-info-panel.js"></script>
        </div>
    </div>
</body>
</html>

